<?xml version="1.0" encoding="UTF-8"?>
<bpmn2:definitions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                   xmlns:bpmn2="http://www.omg.org/spec/BPMN/20100524/MODEL" 
                   xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" 
                   xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" 
                   xmlns:di="http://www.omg.org/spec/DD/20100524/DI"
                   xmlns:flowable="http://flowable.org/bpmn"
                   id="RetentionOfferProcessDefinitions" 
                   targetNamespace="http://www.retention.process" 
                   exporter="Flowable Open Source Modeler" 
                   exporterVersion="6.8.0">
  
  <bpmn2:process id="retentionOfferProcess" name="Retention Offer Approval Process" isExecutable="true">
    
    <!-- Start Event -->
    <bpmn2:startEvent id="startEvent" name="Start Retention Process">
      <bpmn2:outgoing>flow1</bpmn2:outgoing>
    </bpmn2:startEvent>
    
    <!-- Submit Offer Task -->
    <bpmn2:userTask id="submitOfferTask" name="Submit Retention Offer" flowable:candidateGroups="hr-team">
      <bpmn2:documentation>HR team submits a retention offer for employee</bpmn2:documentation>
      <bpmn2:extensionElements>
        <flowable:formProperty id="employeeName" name="Employee Name" type="string" required="true"/>
        <flowable:formProperty id="currentSalary" name="Current Salary" type="long" required="true"/>
        <flowable:formProperty id="proposedSalary" name="Proposed Salary" type="long" required="true"/>
        <flowable:formProperty id="retentionBonus" name="Retention Bonus" type="long"/>
        <flowable:formProperty id="effectiveDate" name="Effective Date" type="date" required="true"/>
        <flowable:formProperty id="justification" name="Justification" type="string" required="true"/>
      </bpmn2:extensionElements>
      <bpmn2:incoming>flow1</bpmn2:incoming>
      <bpmn2:outgoing>flow2</bpmn2:outgoing>
    </bpmn2:userTask>
    
    <!-- Manager Review Task -->
    <bpmn2:userTask id="managerReviewTask" name="Manager Review" flowable:candidateGroups="managers">
      <bpmn2:documentation>Direct manager reviews and approves the retention offer</bpmn2:documentation>
      <bpmn2:extensionElements>
        <flowable:formProperty id="managerApproval" name="Manager Approval" type="enum" required="true">
          <flowable:value id="approve" name="Approve"/>
          <flowable:value id="reject" name="Reject"/>
          <flowable:value id="modify" name="Request Modification"/>
        </flowable:formProperty>
        <flowable:formProperty id="managerComments" name="Manager Comments" type="string"/>
      </bpmn2:extensionElements>
      <bpmn2:incoming>flow2</bpmn2:incoming>
      <bpmn2:incoming>flow8</bpmn2:incoming>
      <bpmn2:outgoing>flow3</bpmn2:outgoing>
    </bpmn2:userTask>
    
    <!-- Gateway: Manager Decision -->
    <bpmn2:exclusiveGateway id="managerDecisionGateway" name="Manager Decision">
      <bpmn2:incoming>flow3</bpmn2:incoming>
      <bpmn2:outgoing>flow4</bpmn2:outgoing>
      <bpmn2:outgoing>flow7</bpmn2:outgoing>
      <bpmn2:outgoing>flow9</bpmn2:outgoing>
    </bpmn2:exclusiveGateway>
    
    <!-- HR Director Review Task -->
    <bpmn2:userTask id="hrDirectorReviewTask" name="HR Director Final Approval" flowable:candidateGroups="hr-directors">
      <bpmn2:documentation>HR Director provides final approval for retention offer</bpmn2:documentation>
      <bpmn2:extensionElements>
        <flowable:formProperty id="finalApproval" name="Final Approval" type="enum" required="true">
          <flowable:value id="approve" name="Approve"/>
          <flowable:value id="reject" name="Reject"/>
        </flowable:formProperty>
        <flowable:formProperty id="directorComments" name="Director Comments" type="string"/>
      </bpmn2:extensionElements>
      <bpmn2:incoming>flow4</bpmn2:incoming>
      <bpmn2:outgoing>flow5</bpmn2:outgoing>
    </bpmn2:userTask>
    
    <!-- Gateway: Final Decision -->
    <bpmn2:exclusiveGateway id="finalDecisionGateway" name="Final Decision">
      <bpmn2:incoming>flow5</bpmn2:incoming>
      <bpmn2:outgoing>flow6</bpmn2:outgoing>
      <bpmn2:outgoing>flow10</bpmn2:outgoing>
    </bpmn2:exclusiveGateway>
    
    <!-- Modify Offer Task -->
    <bpmn2:userTask id="modifyOfferTask" name="Modify Offer" flowable:candidateGroups="hr-team">
      <bpmn2:documentation>HR team modifies the retention offer based on feedback</bpmn2:documentation>
      <bpmn2:extensionElements>
        <flowable:formProperty id="modifiedProposedSalary" name="Modified Proposed Salary" type="long"/>
        <flowable:formProperty id="modifiedRetentionBonus" name="Modified Retention Bonus" type="long"/>
        <flowable:formProperty id="modificationReason" name="Modification Reason" type="string" required="true"/>
      </bpmn2:extensionElements>
      <bpmn2:incoming>flow7</bpmn2:incoming>
      <bpmn2:outgoing>flow8</bpmn2:outgoing>
    </bpmn2:userTask>
    
    <!-- Approved End Event -->
    <bpmn2:endEvent id="approvedEndEvent" name="Offer Approved">
      <bpmn2:incoming>flow6</bpmn2:incoming>
    </bpmn2:endEvent>
    
    <!-- Rejected End Event -->
    <bpmn2:endEvent id="rejectedEndEvent" name="Offer Rejected">
      <bpmn2:incoming>flow9</bpmn2:incoming>
      <bpmn2:incoming>flow10</bpmn2:incoming>
    </bpmn2:endEvent>
    
    <!-- Sequence Flows -->
    <bpmn2:sequenceFlow id="flow1" sourceRef="startEvent" targetRef="submitOfferTask"/>
    <bpmn2:sequenceFlow id="flow2" sourceRef="submitOfferTask" targetRef="managerReviewTask"/>
    <bpmn2:sequenceFlow id="flow3" sourceRef="managerReviewTask" targetRef="managerDecisionGateway"/>
    <bpmn2:sequenceFlow id="flow4" name="Approve" sourceRef="managerDecisionGateway" targetRef="hrDirectorReviewTask">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression">${managerApproval == 'approve'}</bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>
    <bpmn2:sequenceFlow id="flow5" sourceRef="hrDirectorReviewTask" targetRef="finalDecisionGateway"/>
    <bpmn2:sequenceFlow id="flow6" name="Approve" sourceRef="finalDecisionGateway" targetRef="approvedEndEvent">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression">${finalApproval == 'approve'}</bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>
    <bpmn2:sequenceFlow id="flow7" name="Modify" sourceRef="managerDecisionGateway" targetRef="modifyOfferTask">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression">${managerApproval == 'modify'}</bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>
    <bpmn2:sequenceFlow id="flow8" sourceRef="modifyOfferTask" targetRef="managerReviewTask"/>
    <bpmn2:sequenceFlow id="flow9" name="Reject" sourceRef="managerDecisionGateway" targetRef="rejectedEndEvent">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression">${managerApproval == 'reject'}</bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>
    <bpmn2:sequenceFlow id="flow10" name="Reject" sourceRef="finalDecisionGateway" targetRef="rejectedEndEvent">
      <bpmn2:conditionExpression xsi:type="bpmn2:tFormalExpression">${finalApproval == 'reject'}</bpmn2:conditionExpression>
    </bpmn2:sequenceFlow>
    
  </bpmn2:process>
  
  <!-- Diagram Information for UI Visualization -->
  <bpmndi:BPMNDiagram id="BPMNDiagram_retentionOfferProcess">
    <bpmndi:BPMNPlane id="BPMNPlane_retentionOfferProcess" bpmnElement="retentionOfferProcess">
      
      <bpmndi:BPMNShape id="BPMNShape_startEvent" bpmnElement="startEvent">
        <dc:Bounds x="100" y="200" width="36" height="36"/>
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="BPMNShape_submitOfferTask" bpmnElement="submitOfferTask">
        <dc:Bounds x="200" y="178" width="100" height="80"/>
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="BPMNShape_managerReviewTask" bpmnElement="managerReviewTask">
        <dc:Bounds x="370" y="178" width="100" height="80"/>
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="BPMNShape_managerDecisionGateway" bpmnElement="managerDecisionGateway">
        <dc:Bounds x="540" y="193" width="50" height="50"/>
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="BPMNShape_hrDirectorReviewTask" bpmnElement="hrDirectorReviewTask">
        <dc:Bounds x="650" y="78" width="100" height="80"/>
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="BPMNShape_finalDecisionGateway" bpmnElement="finalDecisionGateway">
        <dc:Bounds x="820" y="93" width="50" height="50"/>
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="BPMNShape_modifyOfferTask" bpmnElement="modifyOfferTask">
        <dc:Bounds x="515" y="300" width="100" height="80"/>
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="BPMNShape_approvedEndEvent" bpmnElement="approvedEndEvent">
        <dc:Bounds x="920" y="100" width="36" height="36"/>
      </bpmndi:BPMNShape>
      
      <bpmndi:BPMNShape id="BPMNShape_rejectedEndEvent" bpmnElement="rejectedEndEvent">
        <dc:Bounds x="920" y="200" width="36" height="36"/>
      </bpmndi:BPMNShape>
      
      <!-- Sequence Flow Shapes -->
      <bpmndi:BPMNEdge id="BPMNEdge_flow1" bpmnElement="flow1">
        <di:waypoint x="136" y="218"/>
        <di:waypoint x="200" y="218"/>
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="BPMNEdge_flow2" bpmnElement="flow2">
        <di:waypoint x="300" y="218"/>
        <di:waypoint x="370" y="218"/>
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="BPMNEdge_flow3" bpmnElement="flow3">
        <di:waypoint x="470" y="218"/>
        <di:waypoint x="540" y="218"/>
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="BPMNEdge_flow4" bpmnElement="flow4">
        <di:waypoint x="565" y="193"/>
        <di:waypoint x="565" y="118"/>
        <di:waypoint x="650" y="118"/>
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="BPMNEdge_flow5" bpmnElement="flow5">
        <di:waypoint x="750" y="118"/>
        <di:waypoint x="820" y="118"/>
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="BPMNEdge_flow6" bpmnElement="flow6">
        <di:waypoint x="870" y="118"/>
        <di:waypoint x="920" y="118"/>
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="BPMNEdge_flow7" bpmnElement="flow7">
        <di:waypoint x="565" y="243"/>
        <di:waypoint x="565" y="300"/>
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="BPMNEdge_flow8" bpmnElement="flow8">
        <di:waypoint x="515" y="340"/>
        <di:waypoint x="420" y="340"/>
        <di:waypoint x="420" y="258"/>
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="BPMNEdge_flow9" bpmnElement="flow9">
        <di:waypoint x="590" y="218"/>
        <di:waypoint x="920" y="218"/>
      </bpmndi:BPMNEdge>
      
      <bpmndi:BPMNEdge id="BPMNEdge_flow10" bpmnElement="flow10">
        <di:waypoint x="845" y="143"/>
        <di:waypoint x="845" y="218"/>
        <di:waypoint x="920" y="218"/>
      </bpmndi:BPMNEdge>
      
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
  
</bpmn2:definitions>